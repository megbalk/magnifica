angle_degrees.beta_t2_Gmax_t3.3 <- angle_radians.beta_t2_Gmax_t3.3 * (180 / pi) #81.83178
angle_radians.beta_t3_Gmax_t4.3 <- acos(dot_product.beta_t3_Gmax_t4.3)
# Convert the angle to degrees
angle_degrees.beta_t3_Gmax_t4.3 <- angle_radians.beta_t3_Gmax_t4.3 * (180 / pi) #99.05575; 80.94425
angle_radians.beta_t4_Gmax_t5.3 <- acos(dot_product.beta_t4_Gmax_t5.3)
# Convert the angle to degrees
angle_degrees.beta_t4_Gmax_t5.3 <- angle_radians.beta_t4_Gmax_t5.3 * (180 / pi) #99.2827; 80.7173
angle_radians.beta_t5_Gmax_t6.3 <- acos(dot_product.beta_t5_Gmax_t6.3)
# Convert the angle to degrees
angle_degrees.beta_t5_Gmax_t6.3 <- angle_radians.beta_t5_Gmax_t6.3 * (180 / pi) #84.82799
angle_radians.beta_t6_Gmax_t7.3 <- acos(dot_product.beta_t6_Gmax_t7.3)
# Convert the angle to degrees
angle_degrees.beta_t6_Gmax_t7.3 <- angle_radians.beta_t6_Gmax_t7.3 * (180 / pi) #93.8104; 86.1896
mag.beta_t1.3 <- magnitude(beta_t1.3)
mag.beta_t2.3 <- magnitude(beta_t2.3)
mag.beta_t3.3 <- magnitude(beta_t3.3)
mag.beta_t4.3 <- magnitude(beta_t4.3)
mag.beta_t5.3 <- magnitude(beta_t5.3)
mag.beta_t6.3 <- magnitude(beta_t6.3)
mag.beta.3 <- c(mag.beta_t1.3, mag.beta_t2.3,
mag.beta_t3.3, mag.beta_t4.3,
mag.beta_t5.3, mag.beta_t6.3, "")
b.t1_gmax.t1$form_trans <- formation_transition
corr_b.t1_gmax.t1 <- c(dot_product.beta_t1_Gmax_t1, dot_product.beta_t1_Gmax_t2,
dot_product.beta_t1_Gmax_t3, dot_product.beta_t1_Gmax_t4,
dot_product.beta_t1_Gmax_t5, dot_product.beta_t1_Gmax_t6)
ang_b.t1_gmax.t1 <- c(angle_degrees.beta_t1_Gmax_t1, angle_degrees.beta_t1_Gmax_t2,
angle_degrees.beta_t1_Gmax_t3, angle_degrees.beta_t1_Gmax_t4,
angle_degrees.beta_t1_Gmax_t5, angle_degrees.beta_t1_Gmax_t6)
b.t1_gmax.t1 <- as.data.frame(cbind(corr_b.t1_gmax.t1, ang_b.t1_gmax.t1))
corr_b.t1_gmax.t1.3 <- c(dot_product.beta_t1_Gmax_t1.3, dot_product.beta_t1_Gmax_t2.3,
dot_product.beta_t1_Gmax_t3.3, dot_product.beta_t1_Gmax_t4.3,
dot_product.beta_t1_Gmax_t5.3, dot_product.beta_t1_Gmax_t6.3)
dot_product.beta_t1_Gmax_t1.3
corr_b.t1_gmax.t1.3 <- c(dot_product.beta_t1_Gmax_t1.3, dot_product.beta_t1_Gmax_t2.3,
dot_product.beta_t1_Gmax_t3.3, dot_product.beta_t1_Gmax_t4.3,
dot_product.beta_t1_Gmax_t5.3, dot_product.beta_t1_Gmax_t6.3)
dot_product.beta_t3_Gmax_t3.3 <- sum(beta_t3_norm.3 * Gmax_tewk_norm.3) #-0.2514228
corr_b.t1_gmax.t1.3 <- c(dot_product.beta_t1_Gmax_t1.3, dot_product.beta_t1_Gmax_t2.3,
dot_product.beta_t1_Gmax_t3.3, dot_product.beta_t1_Gmax_t4.3,
dot_product.beta_t1_Gmax_t5.3, dot_product.beta_t1_Gmax_t6.3)
corr_b.t1_gmax.t1.3 <- c(dot_product.beta_t1_Gmax_t1.3, dot_product.beta_t2_Gmax_t2.3,
dot_product.beta_t3_Gmax_t3.3, dot_product.beta_t4_Gmax_t4.3,
dot_product.beta_t5_Gmax_t5.3, dot_product.beta_t6_Gmax_t6.3)
ang_b.t1_gmax.t1.3 <- c(angle_degrees.beta_t1_Gmax_t1.3, angle_degrees.beta_t2_Gmax_t2.3,
angle_degrees.beta_t3_Gmax_t3.3, angle_degrees.beta_t4_Gmax_t4.3,
angle_degrees.beta_t5_Gmax_t5.3, angle_degrees.beta_t6_Gmax_t6.3)
b.t1_gmax.t1.3 <- as.data.frame(cbind(corr_b.t1_gmax.t1.3, ang_b.t1_gmax.t1.3))
b.t1_gmax.t1.3$form_trans <- formation_transition
corr_b.t1_gmax.t1.3 <- c(dot_product.beta_t1_Gmax_t1.3, dot_product.beta_t2_Gmax_t2.3,
dot_product.beta_t3_Gmax_t3.3, dot_product.beta_t4_Gmax_t4.3,
dot_product.beta_t5_Gmax_t5.3, dot_product.beta_t6_Gmax_t6.3)
ang_b.t1_gmax.t1.3 <- c(angle_degrees.beta_t1_Gmax_t1.3, angle_degrees.beta_t2_Gmax_t2.3,
angle_degrees.beta_t3_Gmax_t3.3, angle_degrees.beta_t4_Gmax_t4.3,
angle_degrees.beta_t5_Gmax_t5.3, angle_degrees.beta_t6_Gmax_t6.3)
b.t1_gmax.t1.3 <- as.data.frame(cbind(corr_b.t1_gmax.t1.3, ang_b.t1_gmax.t1.3))
b.t1_gmax.t1.3$form_trans <- formation_transition[-7]
corr_b.t1_gmax.t1.3 <- c(dot_product.beta_t1_Gmax_t1.3, dot_product.beta_t2_Gmax_t2.3,
dot_product.beta_t3_Gmax_t3.3, dot_product.beta_t4_Gmax_t4.3,
dot_product.beta_t5_Gmax_t5.3, dot_product.beta_t6_Gmax_t6.3)
ang_b.t1_gmax.t1.3 <- c(angle_degrees.beta_t1_Gmax_t1.3, angle_degrees.beta_t2_Gmax_t2.3,
angle_degrees.beta_t3_Gmax_t3.3, angle_degrees.beta_t4_Gmax_t4.3,
angle_degrees.beta_t5_Gmax_t5.3, angle_degrees.beta_t6_Gmax_t6.3)
b.t1_gmax.t1.3 <- as.data.frame(cbind(corr_b.t1_gmax.t1.3, ang_b.t1_gmax.t1.3))
b.t1_gmax.t1.3$form <- formation_list[-7]
corr_b.t1_b.t2.3 <- c(dot_product.beta_t1_beta_t2.3, dot_product.beta_t2_beta_t3.3,
dot_product.beta_t3_beta_t4.3, dot_product.beta_t4_beta_t5.3,
dot_product.beta_t5_beta_t6.3)
ang_b.t1_b.t2.3 <- c(angle_degrees.beta_t1_beta_t2.3, angle_degrees.beta_t2_beta_t3.3,
angle_degrees.beta_t3_beta_t4.3, angle_degrees.beta_t4_beta_t5.3,
angle_degrees.beta_t5_beta_t6.3)
b.t1_b.t2.3 <- as.data.frame(cbind(corr_b.t1_b.t2.3, ang_b.t1_b.t2.3))
b.t1_b.t2.3$form_trans <- formation_transition
corr_b.t1_b.t2.3 <- c(dot_product.beta_t1_beta_t2.3, dot_product.beta_t2_beta_t3.3,
dot_product.beta_t3_beta_t4.3, dot_product.beta_t4_beta_t5.3,
dot_product.beta_t5_beta_t6.3)
ang_b.t1_b.t2.3 <- c(angle_degrees.beta_t1_beta_t2.3, angle_degrees.beta_t2_beta_t3.3,
angle_degrees.beta_t3_beta_t4.3, angle_degrees.beta_t4_beta_t5.3,
angle_degrees.beta_t5_beta_t6.3)
b.t1_b.t2.3 <- as.data.frame(cbind(corr_b.t1_b.t2.3, ang_b.t1_b.t2.3))
b.t1_b.t2.3$form_trans <- formation_transition[-7]
corr_b.t1_b.t2.3 <- c(dot_product.beta_t1_beta_t2.3, dot_product.beta_t2_beta_t3.3,
dot_product.beta_t3_beta_t4.3, dot_product.beta_t4_beta_t5.3,
dot_product.beta_t5_beta_t6.3)
ang_b.t1_b.t2.3 <- c(angle_degrees.beta_t1_beta_t2.3, angle_degrees.beta_t2_beta_t3.3,
angle_degrees.beta_t3_beta_t4.3, angle_degrees.beta_t4_beta_t5.3,
angle_degrees.beta_t5_beta_t6.3)
b.t1_b.t2.3 <- as.data.frame(cbind(corr_b.t1_b.t2.3, ang_b.t1_b.t2.3))
b.t1_b.t2.3$form_trans <- formation_transition[c(-6,-7)]
write.csv(b.t1_gmax.t1.3,
"Results/b.t1_gmax.t1.3zoo.csv",
row.names = FALSE)
write.csv(b.t1_b.t2.3,
"Results/b.t1_b.t2.3zoo.csv",
row.names = FALSE)
dot_product.beta_t1_Gmax_t2.3
corr_b.t1_gmax.t2.3 <- c(dot_product.beta_t1_Gmax_t2.3, dot_product.beta_t2_Gmax_t3.3,
dot_product.beta_t3_Gmax_t4.3, dot_product.beta_t4_Gmax_t5.3,
dot_product.beta_t5_Gmax_t6.3, dot_product.beta_t6_Gmax_t7.3)
ang_b.t1_gmax.t2.3 <- c(angle_degrees.beta_t1_Gmax_t2.3, angle_degrees.beta_t2_Gmax_t3.3,
angle_degrees.beta_t3_Gmax_t4.3, angle_degrees.beta_t4_Gmax_t5.3,
angle_degrees.beta_t5_Gmax_t6.3, angle_degrees.beta_t6_Gmax_t7.3)
b.t1_gmax.t2.3 <- as.data.frame(cbind(corr_b.t1_gmax.t2.3, ang_b.t1_gmax.t2.3))
b.t1_gmax.t2.3$form_trans <- formation_transition[-7]
write.csv(b.t1_gmax.t2.3,
"Results/b.t1_gmax.t2.3zoo.csv",
row.names = FALSE)
ang.diff.gmax.b.shcsbsb.mod.3
mag.beta.3
diff.gmax.b.nkls.nkbs.3
diff.gmax.b.nkls.nkbs.3 <- abs(dot_product.Gmax_NKLS_NKBS.3) - abs(dot_product.beta_t1_Gmax_t2.3)
diff.gmax.b.nkbs.tewk.3 <- abs(dot_product.Gmax_NKBS_tewk.3) - abs(dot_product.beta_t2_Gmax_t3.3)
diff.gmax.b.tewk.uki.3 <- abs(dot_product.Gmax_tewk_uki.3) - abs(dot_product.beta_t3_Gmax_t4.3)
diff.gmax.b.uki.tai.3 <- abs(dot_product.Gmax_uki_tai.3) - abs(dot_product.beta_t4_Gmax_t5.3)
diff.gmax.b.tai.shcsbsb.3 <- abs(dot_product.Gmax_tai_SHCSBSB.3) - abs(dot_product.beta_t5_Gmax_t6.3)
diff.gmax.b.shcsbsb.mod.3 <- abs(dot_product.Gmax_SHCSBSB_mod.3) - abs(dot_product.beta_t6_Gmax_t7.3)
diff.gmax.b.3 <- c(diff.gmax.b.nkls.nkbs.3, diff.gmax.b.nkbs.tewk.3,
diff.gmax.b.tewk.uki.3, diff.gmax.b.uki.tai.3,
diff.gmax.b.tai.shcsbsb.3, diff.gmax.b.shcsbsb.mod.3, "")
ang.diff.gmax.b.nkls.nkbs.3 <- abs(angle_degrees.Gmax_NKLS_NKBS) - abs(angle_radians.beta_t1_Gmax_t2.3)
ang.diff.gmax.b.nkbs.tewk.3 <- abs(angle_degrees.Gmax_NKBS_tewk.3) - abs(angle_radians.beta_t2_Gmax_t3.3)
ang.diff.gmax.b.tewk.uki.3 <- abs(angle_degrees.Gmax_tewk_uki.3) - abs(angle_radians.beta_t3_Gmax_t4.3)
ang.diff.gmax.b.uki.tai.3 <- abs(angle_degrees.Gmax_uki_tai.3) - abs(angle_radians.beta_t4_Gmax_t5.3)
ang.diff.gmax.b.tai.shcsbsb.3 <- abs(angle_degrees.Gmax_tai_SHCSBSB.3) - abs(angle_radians.beta_t5_Gmax_t6.3)
ang.diff.gmax.b.shcsbsb.mod.3 <- abs(angle_degrees.Gmax_SHCSBSB_mod.3) - abs(angle_radians.beta_t6_Gmax_t7.3)
ang.diff.gmax.b.3 <- c(ang.diff.gmax.b.nkls.nkbs.3, ang.diff.gmax.b.nkbs.tewk.3,
ang.diff.gmax.b.tewk.uki.3, ang.diff.gmax.b.uki.tai.3,
ang.diff.gmax.b.tai.shcsbsb.3, ang.diff.gmax.b.shcsbsb.mod.3, "")
diff.beta.gmax.df.3 <- as.data.frame(cbind(mag.beta.3, diff.gmax.b.3, formation_transition, ang.diff.gmax.b.3))
diff.beta.gmax.df.3$formation_transition <- factor(diff.beta.gmax.df.3$formation_transition,
levels = c("NKLS to NKBS",
"NKBS to Tewkesbury",
"Tewkesbury to Upper Kai-Iwi",
"Upper Kai-Iwi to Tainui",
"Tainui to SHCSBSB",
"SHCSBSB to modern", ""))
summary(lm(as.numeric(diff.gmax.b.3) ~ as.numeric(mag.beta.3),
data = diff.beta.gmax.df.3)) #barely sig at 0.04184; slope at 0, r2 at 0.61
summary(lm(as.numeric(ang.diff.gmax.b.3) ~ as.numeric(mag.beta.3),
data = diff.beta.gmax.df.3)) #nonsig at 0.1064; slope barely over 0, r2 0.3985
dist.NKLS_NKBS.3 <- RiemannDist(G_ext_NKBS.3, G_ext_NKLS.3)
dist.NKBS_tewk.3 <- RiemannDist(G_ext_NKLS.3, G_ext_tewk.3)
dist.tewk_uki.3 <- RiemannDist(G_ext_tewk.3, G_ext_uki.3)
dist.uki_tai.3 <- RiemannDist(G_ext_uki.3, G_ext_tai.3)
dist.tai_SHCSBSB.3 <- RiemannDist(G_ext_tai.3, G_ext_SHCSBSB.3)
dist.SHCSBSB_mod.3 <- RiemannDist(G_ext_SHCSBSB.3, G_ext_mod.3)
dist.gmat.3 <- c(dist.NKLS_NKBS.3, dist.NKBS_tewk.3,
dist.tewk_uki.3, dist.uki_tai.3,
dist.tai_SHCSBSB.3, dist.SHCSBSB_mod.3, "")
diff.beta.gmax.df.3 <- cbind(diff.beta.gmax.df.3, dist.gmat.3)
summary(lm(as.numeric(dist.gmat.3) ~ as.numeric(mag.beta.3),
data = diff.beta.gmax.df.3)) #nonsig at p = 0.4008; no relationship
mean_by_formation
mean_by_formation$raw.var.zh <- exp(mean_by_formation$var.zh)
exp(mean_by_formation$var.zh)
mean_by_formation$raw.var.zh <- exp(mean_by_formation$var.zh)
form.variances <- as.data.frame(cbind(levels(formation_list),
raw.var.zh, raw.var.mpw.b,
raw.var.cw.m, raw.var.cw.d,
raw.var.ow.m, raw.var.oh,
raw.var.o.side, raw.var.o.side))
raw.var.zh <- exp(mean_by_formation$var.zh)
raw.var.mpw.b <- exp(mean_by_formation$var.mpw.b)
raw.var.cw.m <- exp(mean_by_formation$var.cw.m)
raw.var.cw.d <- exp(mean_by_formation$var.cw.d)
raw.var.ow.m <- exp(mean_by_formation$var.ow.m)
raw.var.oh <- exp(mean_by_formation$var.oh)
raw.var.o.side <- exp(mean_by_formation$var.o.side)
raw.var.c.side <- exp(mean_by_formation$var.c.side)
form.variances <- as.data.frame(cbind(levels(formation_list),
raw.var.zh, raw.var.mpw.b,
raw.var.cw.m, raw.var.cw.d,
raw.var.ow.m, raw.var.oh,
raw.var.o.side, raw.var.c.side))
form.variances
form.variances <- as.data.frame(cbind(formation_list,
raw.var.zh, raw.var.mpw.b,
raw.var.cw.m, raw.var.cw.d,
raw.var.ow.m, raw.var.oh,
raw.var.o.side, raw.var.c.side))
form.variances
mean_by_formation$formation
form.variances <- as.data.frame(cbind(levels(formation_list),
raw.var.zh, raw.var.mpw.b,
raw.var.cw.m, raw.var.cw.d,
raw.var.ow.m, raw.var.oh,
raw.var.o.side, raw.var.c.side))
colnames(mean_by_formation)
dplyr::summarise(per.var.zh = (exp(var.zh)/(exp(var.zh[formation == "modern"])))
)
for(i in 1:6){
per.var.zh[i] <- exp(mean_by_formation$var.zh[i])/exp(mean_by_formation$var.zh[mean_by_formation$formation == "modern"])
per.var.mpw.b[i] <- exp(mean_by_formation$var.mpw.b[i])/exp(mean_by_formation$var.mpw.b[mean_by_formation$formation == "modern"])
per.var.cw.m[i] <- exp(mean_by_formation$var.cw.m[i])/exp(mean_by_formation$var.cw.m[mean_by_formation$formation == "modern"])
per.var.cw.d[i] <- exp(mean_by_formation$var.cw.d[i])/exp(mean_by_formation$var.cw.d[mean_by_formation$formation == "modern"])
per.var.ow.m[i] <- exp(mean_by_formation$var.ow.m[i])/exp(mean_by_formation$var.ow.m[mean_by_formation$formation == "modern"])
per.var.oh[i] <- exp(mean_by_formation$var.oh[i])/exp(mean_by_formation$var.oh[mean_by_formation$formation == "modern"])
per.var.o.side[i] <- exp(mean_by_formation$var.o.side[i])/exp(mean_by_formation$var.o.side[mean_by_formation$formation == "modern"])
per.var.c.side[i] <- exp(mean_by_formation$var.c.side[i])/exp(mean_by_formation$var.c.side[mean_by_formation$formation == "modern"])
}
per.var.zh <- c()
per.var.mpw.b <- c()
per.var.cw.m <- c()
per.var.cw.d <- c()
per.var.ow.m <- c()
per.var.oh <- c()
per.var.o.side <- c()
per.var.c.side <- c()
for(i in 1:6){
per.var.zh[i] <- exp(mean_by_formation$var.zh[i])/exp(mean_by_formation$var.zh[mean_by_formation$formation == "modern"])
per.var.mpw.b[i] <- exp(mean_by_formation$var.mpw.b[i])/exp(mean_by_formation$var.mpw.b[mean_by_formation$formation == "modern"])
per.var.cw.m[i] <- exp(mean_by_formation$var.cw.m[i])/exp(mean_by_formation$var.cw.m[mean_by_formation$formation == "modern"])
per.var.cw.d[i] <- exp(mean_by_formation$var.cw.d[i])/exp(mean_by_formation$var.cw.d[mean_by_formation$formation == "modern"])
per.var.ow.m[i] <- exp(mean_by_formation$var.ow.m[i])/exp(mean_by_formation$var.ow.m[mean_by_formation$formation == "modern"])
per.var.oh[i] <- exp(mean_by_formation$var.oh[i])/exp(mean_by_formation$var.oh[mean_by_formation$formation == "modern"])
per.var.o.side[i] <- exp(mean_by_formation$var.o.side[i])/exp(mean_by_formation$var.o.side[mean_by_formation$formation == "modern"])
per.var.c.side[i] <- exp(mean_by_formation$var.c.side[i])/exp(mean_by_formation$var.c.side[mean_by_formation$formation == "modern"])
}
per.var.zh
1-per.var.zh/100
per.var.zh/100
exp(mean_by_formation$var.zh)*1.002
exp(mean_by_formation$var.zh)*1.0028090
exp(mean_by_formation$var.zh[mean_by_formation$formation == "modern"])*1.0028090
exp(mean_by_formation$var.zh[1])
exp(mean_by_formation$var.zh[7])
1.014788/1.011946
exp(mean_by_formation$var.zh[7])*.1.2
exp(mean_by_formation$var.zh[7])*1.2
1.011946*1.0028090
1.011946*.0028090
0.002842556+1.011946
(1-per.var.zh)*100
per.var.zh
(per.var.zh-1)*100
(per.var.zh-1)*100
(per.var.mpw.b-1)*100
(per.var.cw.m-1)*100
(per.var.cw.d-1)*100
(per.var.ow.m-1)*100
(per.var.oh-1)*100
(per.var.o.side-1)*100
(per.var.c.side-1)*100
(per.var.zh-1)*100 #less than.
mean(sum((per.var.zh-1)*100))
mean(sum((per.var.mpw.b-1)*100))
mean(sum((per.var.cw.m-1)*100))
mean(sum((per.var.cw.d-1)*100))
mean(sum((per.var.ow.m-1)*100))
mean(sum((per.var.oh-1)*100))
mean(sum((per.var.o.side-1)*100))
mean(sum((per.var.c.side-1)*100))
mean(sum((per.var.c.side-1)*100)) #avg 4%
per.var.c.side
(per.var.c.side-1)*100)
(per.var.c.side-1)*100
sum((per.var.c.side-1)*100)
mean((per.var.zh-1)*100) #less than 1 % (.9%)
mean((per.var.mpw.b-1)*100) #avg. 2.6%
mean((per.var.cw.m-1)*100) #avg 1.1%
mean((per.var.cw.d-1)*100) #avg 1.5%
mean((per.var.ow.m-1)*100) #avg 1.1%
mean((per.var.oh-1)*100) #avg .6 %
mean((per.var.o.side-1)*100) #less than 1 % (.9%)
mean((per.var.c.side-1)*100) #avg 4%
df <- read.csv("Data/traits_27May2024.csv", #30Nov2023,29Sept2023.csv",
header = TRUE)
mod <- df[df$formation == "modern",]
mean_by_formation
df %>% #use this going forward
dplyr::group_by(formation, colony.id) %>%
dplyr::summarize(n.zooid = length(zooid.id),
avg.zh = mean(zh, na.rm = T),
avg.mpw.b = mean(mpw.b, na.rm = T),
avg.cw.m = mean(cw.m, na.rm = T),
avg.cw.d = mean(cw.d, na.rm = T),
avg.ow.m = mean(ow.m, na.rm = T),
avg.oh = mean(oh, na.rm = T),
avg.o.side = mean(o.side, na.rm = T),
avg.c.side = mean(c.side, na.rm = T)) %>%
as.data.frame()
df %>% #use this going forward
dplyr::group_by(formation, colony.id) %>%
dplyr::summarize(n.zooid = length(zooid.id),
avg.zh = mean(zh, na.rm = T),
avg.mpw.b = mean(mpw.b, na.rm = T),
avg.cw.m = mean(cw.m, na.rm = T),
avg.cw.d = mean(cw.d, na.rm = T),
avg.ow.m = mean(ow.m, na.rm = T),
avg.oh = mean(oh, na.rm = T),
avg.o.side = mean(o.side, na.rm = T),
avg.c.side = mean(c.side, na.rm = T)) %>%
as.data.frame()
colnames(df)
str(df)
df$formation <- factor(df$formation,
levels = c("NKLS", "NKBS", "Tewkesbury",
"Upper Kai-Iwi", "Tainui",
"SHCSBSB", "modern"))
#### MODERN ----
#why is modern so different??
df$formation <- factor(df$formation,
levels = c("NKLS", "NKBS", "Tewkesbury",
"Upper Kai-Iwi", "Tainui",
"SHCSBSB", "modern"))
df %>% #use this going forward
dplyr::group_by(formation, colony.id) %>%
dplyr::summarize(n.zooid = length(zooid.id),
avg.zh = mean(zh, na.rm = T),
avg.mpw.b = mean(mpw.b, na.rm = T),
avg.cw.m = mean(cw.m, na.rm = T),
avg.cw.d = mean(cw.d, na.rm = T),
avg.ow.m = mean(ow.m, na.rm = T),
avg.oh = mean(oh, na.rm = T),
avg.o.side = mean(o.side, na.rm = T),
avg.c.side = mean(c.side, na.rm = T)) %>%
as.data.frame()
df %>% #use this going forward
dplyr::group_by(formation) %>%
dplyr::summarize(n.col = length(unique(colony.id)),
n.zooid = length(zooid.id),
avg.zh = mean(zh, na.rm = T),
avg.mpw.b = mean(mpw.b, na.rm = T),
avg.cw.m = mean(cw.m, na.rm = T),
avg.cw.d = mean(cw.d, na.rm = T),
avg.ow.m = mean(ow.m, na.rm = T),
avg.oh = mean(oh, na.rm = T),
avg.o.side = mean(o.side, na.rm = T),
avg.c.side = mean(c.side, na.rm = T)) %>%
as.data.frame()
p.zh = ggplot(data = df) +
geom_density(aes(x = df[, traits[1]],
group = formation,
col = formation)) +
plot.theme +
scale_x_continuous(name = traits[1]) +
scale_color_manual(values = col.form)
df <- read.csv("./Results/colonies.traits_27May2024.csv",
header = TRUE,
sep = ",",
stringsAsFactors = FALSE)
# arrange formations from oldest to youngest
df$formation <- factor(df$formation, levels = c("NKLS", "NKBS", "Tewkesbury",
"Upper Kai-Iwi",  "Tainui",
"SHCSBSB", "modern"))
formation_list <- unique(df$formation)
length(formation_list) #7
#same order as in df
names(df)
traits = names(df[, c("ln.zh", "ln.mpw.b", "ln.cw.m", "ln.cw.d",
"ln.ow.m", "ln.oh", "ln.c.side", "ln.o.side")])
length(traits) #8
##### TRIM DATASET ----
df.trim <- df %>%
dplyr::select(zooid.id, colony.id, formation, matches(traits))
colNums <- match(c(traits, "zooid.id"), names(df.trim))
df = as.data.frame(df.trim)
p.zh = ggplot(data = df) +
geom_density(aes(x = df[, traits[1]],
group = formation,
col = formation)) +
plot.theme +
scale_x_continuous(name = traits[1]) +
scale_color_manual(values = col.form)
p.mpw.b = ggplot(data = df) +
geom_density(aes(x = df[, traits[2]],
group = formation,
col = formation)) +
plot.theme +
scale_x_continuous(name = traits[2]) +
scale_color_manual(values = col.form)
p.cw.m = ggplot(data = df) +
geom_density(aes(x = df[, traits[3]],
group = formation,
col = formation)) +
plot.theme +
scale_x_continuous(name = traits[3]) +
scale_color_manual(values = col.form)
p.cw.d = ggplot(data = df) +
geom_density(aes(x = df[, traits[4]],
group = formation,
col = formation)) +
plot.theme +
scale_x_continuous(name = traits[4]) +
scale_color_manual(values = col.form)
p.ow.m = ggplot(data = df) +
geom_density(aes(x = df[, traits[5]],
group = formation,
col = formation)) +
plot.theme +
scale_x_continuous(name = traits[5]) +
scale_color_manual(values = col.form)
p.oh = ggplot(data = df) +
geom_density(aes(x = df[, traits[6]],
group = formation,
col = formation)) +
plot.theme +
scale_x_continuous(name = traits[6]) +
scale_color_manual(values = col.form)
p.c.side = ggplot(data = df) +
geom_density(aes(x = df[, traits[7]],
group = formation,
col = formation)) +
plot.theme +
scale_x_continuous(name = traits[7]) +
scale_color_manual(values = col.form)
p.o.side = ggplot(data = df) +
geom_density(aes(x = df[, traits[8]],
group = formation,
col = formation)) +
plot.theme +
scale_x_continuous(name = traits[8]) +
scale_color_manual(values = col.form)
Fig = list(p.zh, p.mpw.b, p.cw.m, p.cw.d, p.ow.m, p.oh, p.c.side, p.o.side)
ml <- marrangeGrob(Fig, nrow = 4, ncol = 2)
ml
formation_list
df %>%
dplyr::group_by(formation) %>%
dplyr::summarize(n.col = length(unique(colony.id)),
n.zooid = length(zooid.id),
avg.zh = mean(zh, na.rm = T),
avg.mpw.b = mean(mpw.b, na.rm = T),
avg.cw.m = mean(cw.m, na.rm = T),
avg.cw.d = mean(cw.d, na.rm = T),
avg.ow.m = mean(ow.m, na.rm = T),
avg.oh = mean(oh, na.rm = T),
avg.o.side = mean(o.side, na.rm = T),
avg.c.side = mean(c.side, na.rm = T)) %>%
as.data.frame()
colnames(df)
#note: using df from 4-exploratory analysis, after get rid of small colonies
df %>%
dplyr::group_by(formation) %>%
dplyr::summarize(n.col = length(unique(colony.id)),
n.zooid = length(zooid.id),
avg.zh = mean(exp(ln.zh, na.rm = T)),
avg.mpw.b = mean(exp(ln.mpw.b, na.rm = T)),
avg.cw.m = mean(exp(ln.cw.m, na.rm = T)),
avg.cw.d = mean(exp(ln.cw.d, na.rm = T)),
avg.ow.m = mean(exp(ln.ow.m, na.rm = T)),
avg.oh = mean(exp(ln.oh, na.rm = T)),
avg.o.side = mean(exp(ln.o.side, na.rm = T)),
avg.c.side = mean(exp(ln.c.side, na.rm = T))) %>%
as.data.frame()
unique(df$formation)
#note: using df from 4-exploratory analysis, after get rid of small colonies
df %>%
dplyr::group_by(formation) %>%
dplyr::summarize(n.col = length(unique(colony.id)),
n.zooid = length(zooid.id),
avg.zh = mean(exp(ln.zh), na.rm = T),
avg.mpw.b = mean(exp(ln.mpw.b), na.rm = T),
avg.cw.m = mean(exp(ln.cw.m), na.rm = T),
avg.cw.d = mean(exp(ln.cw.d), na.rm = T),
avg.ow.m = mean(exp(ln.ow.m), na.rm = T),
avg.oh = mean(exp(ln.oh), na.rm = T),
avg.o.side = mean(exp(ln.o.side), na.rm = T),
avg.c.side = mean(exp(ln.c.side), na.rm = T)) %>%
as.data.frame()
G_PC_dist
g.eig_variances
g.eig_per
P_PC_dist
g.eig_per$rownames.g.eig_per_mat. <- factor(g.eig_per$rownames.g.eig_per_mat.,
levels = c("NKLS", "NKBS", "Tewkesbury",
"Upper Kai-Iwi", "Tainui",
"SHCSBSB", "modern"))
#dev.off()
G_PC_dist = ggplot(g.eig_per,
aes(x = variable, y = value,
group = rownames.g.eig_per_mat.,
colour = rownames.g.eig_per_mat.)) +
geom_line(aes(linetype = rownames.g.eig_per_mat.)) +
geom_point() +
plot.theme +
theme_linedraw() +
scale_x_discrete("Principal component rank",
labels = c("PC1", "PC2", "PC3", "PC4",
"PC5", "PC6", "PC7", "PC8")) +
scale_y_continuous("%Variation in the PC",
limits = c(-.02, 0.7))
G_PC_dist
ggsave(G_PC_dist,
file = "./Results/G.PC.dist.png",
width = 14, height = 10, units = "cm")
#dev.off()
G_PC_dist = ggplot(g.eig_per,
aes(x = variable, y = value,
group = rownames.g.eig_per_mat.,
colour = rownames.g.eig_per_mat.)) +
geom_line(aes(linetype = rownames.g.eig_per_mat.)) +
geom_point() +
plot.theme +
theme_linedraw() +
scale_x_discrete("Principal component rank",
labels = c("PC1", "PC2", "PC3", "PC4",
"PC5", "PC6", "PC7", "PC8")) +
scale_y_continuous("%Variation in the PC",
limits = c(-.02, 0.7)) +
scale_color_manual(values = col.form)
G_PC_dist
G_PC_dist
q
ggsave(G_PC_dist,
file = "./Results/G.PC.dist.png",
width = 14, height = 10, units = "cm")
ggsave(G_PC_dist.3,
file = "./Results/G.PC.dist.3zoo.png",
width = 14, height = 10, units = "cm") #modern still wonky
#https://www.statology.org/principal-components-analysis-in-r/
G_pc <- lapply(Gmat, function (x) {prcomp(x, scale = TRUE)})
